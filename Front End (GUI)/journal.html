<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Journal</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <div class="page">
    <div class="card wide">

      <div class="icon">ğŸ“</div>

      <h1>Daily Journal</h1>
      <p class="subtitle">
        Write your thoughts freely. Weâ€™ll help you reflect âœ¨
      </p>

      <!-- ğŸŒ™ DARK MODE -->
      <button class="secondary-btn" type="button" onclick="toggleDark()">
        Toggle Dark Mode ğŸŒ™
      </button>

      <!-- JOURNAL INPUT -->
      <div class="field">
        <label>Your Journal</label>
        <textarea id="journalText" rows="6"
          placeholder="Write your thoughts here..."></textarea>
      </div>

      <!-- MOOD -->
      <div class="field">
        <label>How are you feeling today?</label>
        <select id="mood">
          <option value="Happy">ğŸ˜Š Happy</option>
          <option value="Neutral">ğŸ˜ Neutral</option>
          <option value="Sad">ğŸ˜” Sad</option>
          <option value="Angry">ğŸ˜¡ Angry</option>
          <option value="Tired">ğŸ˜´ Tired</option>
        </select>
      </div>

      <button class="primary-btn" type="button" onclick="submitJournal()">
        Analyze with Gemini
      </button>

      <!-- RESULT -->
      <div id="result" class="result" style="display:none;">
        <p><strong>Gemini Analysis</strong></p>
        <p id="sentimentText"></p>
      </div>

      <a class="link" href="welcome.html">Back to Home</a>

      <div class="footer">
        Your journal is private and stored securely ğŸŒ±
      </div>

    </div>
  </div>

  <script>
    function submitJournal() {
      const text = document.getElementById("journalText").value.trim();
      const mood = document.getElementById("mood").value;
      const resultBox = document.getElementById("result");
      const sentimentText = document.getElementById("sentimentText");

      if (text === "") {
        alert("Please write something first.");
        return;
      }

      sentimentText.innerText = "Analyzing with Gemini...";
      resultBox.style.display = "block";

      // === SEND TO JAVA BACKEND ===
      fetch("http://localhost:8080/journal", {
        method: "POST",
        body: `Mood: ${mood}\n\n${text}`
      })
      .then(res => res.text())
      .then(response => {
        sentimentText.innerText = response;
      })
      .catch(err => {
        sentimentText.innerText = "Failed to connect to backend.";
      });
    }

    function toggleDark() {
      document.body.classList.toggle("dark");
    }
  </script>

</body>
</html>
